<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ãƒã‚¤ã‚¯ãƒ­ãƒ—ãƒ©ã‚¹ãƒãƒƒã‚¯æ‘‚å–é‡ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    input[type="range"] {
      -webkit-appearance: none;
      appearance: none;
      height: 8px;
      border-radius: 4px;
      background: #e5e7eb;
    }
    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #2563eb;
      cursor: pointer;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
    input[type="range"]::-moz-range-thumb {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #2563eb;
      cursor: pointer;
      border: none;
    }
  </style>
</head>
<body class="bg-gradient-to-br from-slate-50 to-blue-50 min-h-screen p-4 md:p-8">
  <div class="max-w-2xl mx-auto" id="app">
    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <div class="text-center mb-8">
      <h1 class="text-2xl md:text-3xl font-bold text-gray-800 mb-2">
        ãƒã‚¤ã‚¯ãƒ­ãƒ—ãƒ©ã‚¹ãƒãƒƒã‚¯æ‘‚å–é‡ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼
      </h1>
      <p class="text-gray-600 text-sm">
        æ—¥å¸¸ã®ç¿’æ…£ã‹ã‚‰ã€ç›¸å¯¾çš„ãªæ‘‚å–é‡ã‚’æ¨å®šã—ã¾ã™
      </p>
    </div>

    <!-- å…¥åŠ›ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-6 mb-6">
      <h2 class="text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2">
        <span class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 text-sm">1</span>
        é€±é–“ã®ç¿’æ…£ã‚’å…¥åŠ›
      </h2>
      
      <!-- ãƒœãƒˆãƒ«æ°´ -->
      <div class="mb-6">
        <div class="flex justify-between items-center mb-2">
          <label class="text-sm font-medium text-gray-700 flex items-center gap-2">
            <span>ğŸ¶</span> ãƒœãƒˆãƒ«æ°´ã®æ¶ˆè²»é‡
          </label>
          <span class="text-sm font-semibold text-gray-900 bg-gray-100 px-3 py-1 rounded-full">
            <span id="bottledWater-value">7</span> L/é€±
          </span>
        </div>
        <input type="range" id="bottledWater" min="0" max="14" value="7" class="w-full" oninput="updateSimulator()">
        <div class="flex justify-between text-xs text-gray-400 mt-1"><span>0</span><span>14</span></div>
      </div>

      <!-- æ°´é“æ°´ -->
      <div class="mb-6">
        <div class="flex justify-between items-center mb-2">
          <label class="text-sm font-medium text-gray-700 flex items-center gap-2">
            <span>ğŸš°</span> æ°´é“æ°´ã®æ¶ˆè²»é‡
          </label>
          <span class="text-sm font-semibold text-gray-900 bg-gray-100 px-3 py-1 rounded-full">
            <span id="tapWater-value">7</span> L/é€±
          </span>
        </div>
        <input type="range" id="tapWater" min="0" max="14" value="7" class="w-full" oninput="updateSimulator()">
        <div class="flex justify-between text-xs text-gray-400 mt-1"><span>0</span><span>14</span></div>
      </div>

      <!-- ãƒ†ã‚£ãƒ¼ãƒãƒƒã‚° -->
      <div class="mb-6">
        <div class="flex justify-between items-center mb-2">
          <label class="text-sm font-medium text-gray-700 flex items-center gap-2">
            <span>ğŸµ</span> ãƒ†ã‚£ãƒ¼ãƒãƒƒã‚°ä½¿ç”¨å›æ•°ï¼ˆãƒ—ãƒ©è£½ï¼‰
          </label>
          <span class="text-sm font-semibold text-gray-900 bg-gray-100 px-3 py-1 rounded-full">
            <span id="teaBags-value">7</span> å›/é€±
          </span>
        </div>
        <input type="range" id="teaBags" min="0" max="21" value="7" class="w-full" oninput="updateSimulator()">
        <div class="flex justify-between text-xs text-gray-400 mt-1"><span>0</span><span>21</span></div>
      </div>

      <!-- ãƒ—ãƒ©å®¹å™¨åŠ ç†± -->
      <div class="mb-6">
        <div class="flex justify-between items-center mb-2">
          <label class="text-sm font-medium text-gray-700 flex items-center gap-2">
            <span>ğŸ“¦</span> ãƒ—ãƒ©å®¹å™¨ã®é›»å­ãƒ¬ãƒ³ã‚¸åŠ ç†±
          </label>
          <span class="text-sm font-semibold text-gray-900 bg-gray-100 px-3 py-1 rounded-full">
            <span id="plasticHeating-value">3</span> å›/é€±
          </span>
        </div>
        <input type="range" id="plasticHeating" min="0" max="14" value="3" class="w-full" oninput="updateSimulator()">
        <div class="flex justify-between text-xs text-gray-400 mt-1"><span>0</span><span>14</span></div>
      </div>
    </div>

    <!-- çµæœã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <div id="result-section" class="rounded-2xl shadow-sm border p-6 mb-6 bg-amber-50 border-amber-200">
      <h2 class="text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2">
        <span class="w-8 h-8 bg-white rounded-full flex items-center justify-center text-gray-600 text-sm shadow-sm">2</span>
        æ¨å®šçµæœ
      </h2>
      
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
        <div class="bg-white/80 backdrop-blur rounded-xl p-4 text-center">
          <div class="text-3xl font-bold text-gray-800" id="weekly-particles">85.8K</div>
          <div class="text-sm text-gray-600">ç²’å­/é€±</div>
        </div>
        <div class="bg-white/80 backdrop-blur rounded-xl p-4 text-center">
          <div class="text-3xl font-bold text-gray-800" id="yearly-particles">4.5M</div>
          <div class="text-sm text-gray-600">ç²’å­/å¹´</div>
        </div>
        <div class="bg-white/80 backdrop-blur rounded-xl p-4 text-center">
          <div class="text-3xl font-bold text-gray-800" id="forty-year-particles">178.4M</div>
          <div class="text-sm text-gray-600">ç²’å­/40å¹´</div>
        </div>
      </div>

      <div class="flex items-center justify-center gap-3 py-3">
        <span class="text-gray-600">æ‘‚å–ãƒ¬ãƒ™ãƒ«:</span>
        <span class="text-xl font-bold" id="level-text">ã‚„ã‚„é«˜ã‚</span>
      </div>

      <!-- å¯„ä¸åº¦ãƒãƒ¼ -->
      <div class="mt-4 bg-white/60 rounded-xl p-4">
        <div class="text-sm font-medium text-gray-700 mb-2">çµŒè·¯åˆ¥ã®å¯„ä¸åº¦</div>
        <div class="flex h-6 rounded-full overflow-hidden bg-gray-100" id="contribution-bar"></div>
        <div class="flex flex-wrap gap-3 mt-2 text-xs" id="contribution-legend"></div>
      </div>
    </div>

    <!-- è¡Œå‹•å¤‰å®¹ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-6 mb-6" id="action-section">
      <h2 class="text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2">
        <span class="w-8 h-8 bg-emerald-100 rounded-full flex items-center justify-center text-emerald-600 text-sm">3</span>
        ä»Šæ—¥ã‹ã‚‰ã§ãã‚‹ã“ã¨
      </h2>
      <div class="space-y-3" id="action-items"></div>
    </div>

    <!-- æ³¨æ„æ›¸ã -->
    <div class="bg-gray-50 rounded-2xl p-6 border border-gray-200">
      <button onclick="toggleDetails()" class="flex items-center justify-between w-full text-left">
        <span class="text-sm font-medium text-gray-700">âš ï¸ æ¨å®šå€¤ã«ã¤ã„ã¦</span>
        <span class="text-gray-400" id="details-arrow">â–¼</span>
      </button>
      
      <div class="mt-4 text-sm text-gray-600 space-y-2 hidden" id="details-content">
        <p><strong>ã“ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ã®é™ç•Œï¼š</strong></p>
        <ul class="list-disc list-inside space-y-1 ml-2">
          <li>æ¸¬å®šæ–¹æ³•ã«ã‚ˆã‚ŠçµæœãŒ2ã€œ5æ¡ç•°ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™</li>
          <li>WWFã®ã€Œé€±5gï¼ˆã‚¯ãƒ¬ã‚«1æšï¼‰ã€èª¬ã¯å­¦è¡“çš„ã«å¦å®šã•ã‚Œã¦ã„ã¾ã™</li>
          <li>å®Ÿéš›ã®æ‘‚å–é‡ã¯æ•°Î¼gã€œæ•°ç™¾mg/é€±ã¨æ¨å®šå¹…ãŒéå¸¸ã«åºƒã„ã§ã™</li>
          <li>å¥åº·ãƒªã‚¹ã‚¯ã®é–¾å€¤ã¯ç¾æ™‚ç‚¹ã§ä¸æ˜ã§ã™</li>
        </ul>
        <p class="mt-3"><strong>ã“ã®ãƒ„ãƒ¼ãƒ«ã®ç›®çš„ï¼š</strong></p>
        <ul class="list-disc list-inside space-y-1 ml-2">
          <li>çµ¶å¯¾é‡ã§ã¯ãªãã€ç›¸å¯¾çš„ãªæ¯”è¼ƒã¨å‚¾å‘æŠŠæ¡</li>
          <li>è¡Œå‹•å¤‰å®¹ã®æ–¹å‘æ€§ã‚’ç¤ºã™ã“ã¨</li>
          <li>ã€Œã©ã®ç¿’æ…£ãŒå½±éŸ¿å¤§ã‹ã€ã®å¯è¦–åŒ–</li>
        </ul>
        <p class="mt-3 text-xs text-gray-500">
          ä¿‚æ•°å‡ºå…¸: Mason 2018, Hernandez 2019, Mohamed Nor 2021, EWG 2024
        </p>
      </div>
    </div>

    <!-- ãƒ•ãƒƒã‚¿ãƒ¼ -->
    <div class="text-center mt-6 text-xs text-gray-400">
      <a href="index.html" class="hover:text-gray-600">Under-Recognized Future Risks Project</a>
    </div>
  </div>

  <script>
    // ä¿‚æ•°
    const COEFFICIENTS = {
      bottledWater: 100,
      tapWater: 10,
      teaBag: 10000,
      plasticHeating: 5000
    };

    const contributorLabels = {
      bottledWater: 'ãƒœãƒˆãƒ«æ°´',
      tapWater: 'æ°´é“æ°´',
      teaBags: 'ãƒ†ã‚£ãƒ¼ãƒãƒƒã‚°',
      plasticHeating: 'ãƒ—ãƒ©å®¹å™¨åŠ ç†±'
    };

    const colors = ['bg-blue-500', 'bg-cyan-500', 'bg-amber-500', 'bg-rose-500'];

    function formatNumber(num) {
      if (num >= 1000000) return `${(num / 1000000).toFixed(1)}M`;
      if (num >= 1000) return `${(num / 1000).toFixed(1)}K`;
      return num.toLocaleString();
    }

    function updateSimulator() {
      const bottledWater = parseInt(document.getElementById('bottledWater').value);
      const tapWater = parseInt(document.getElementById('tapWater').value);
      const teaBags = parseInt(document.getElementById('teaBags').value);
      const plasticHeating = parseInt(document.getElementById('plasticHeating').value);

      // å€¤è¡¨ç¤ºã‚’æ›´æ–°
      document.getElementById('bottledWater-value').textContent = bottledWater;
      document.getElementById('tapWater-value').textContent = tapWater;
      document.getElementById('teaBags-value').textContent = teaBags;
      document.getElementById('plasticHeating-value').textContent = plasticHeating;

      // è¨ˆç®—
      const contributions = {
        bottledWater: bottledWater * COEFFICIENTS.bottledWater,
        tapWater: tapWater * COEFFICIENTS.tapWater,
        teaBags: teaBags * COEFFICIENTS.teaBag,
        plasticHeating: plasticHeating * COEFFICIENTS.plasticHeating
      };

      const weeklyParticles = Object.values(contributions).reduce((a, b) => a + b, 0);
      const yearlyParticles = weeklyParticles * 52;
      const fortyYearParticles = yearlyParticles * 40;

      // çµæœè¡¨ç¤º
      document.getElementById('weekly-particles').textContent = formatNumber(weeklyParticles);
      document.getElementById('yearly-particles').textContent = formatNumber(yearlyParticles);
      document.getElementById('forty-year-particles').textContent = formatNumber(fortyYearParticles);

      // ãƒ¬ãƒ™ãƒ«åˆ¤å®š
      let level, levelColor, bgClass, borderClass;
      if (weeklyParticles < 1000) {
        level = 'ä½'; levelColor = 'text-emerald-700';
        bgClass = 'bg-emerald-50'; borderClass = 'border-emerald-200';
      } else if (weeklyParticles < 10000) {
        level = 'å¹³å‡çš„'; levelColor = 'text-blue-700';
        bgClass = 'bg-blue-50'; borderClass = 'border-blue-200';
      } else if (weeklyParticles < 100000) {
        level = 'ã‚„ã‚„é«˜ã‚'; levelColor = 'text-amber-700';
        bgClass = 'bg-amber-50'; borderClass = 'border-amber-200';
      } else {
        level = 'é«˜'; levelColor = 'text-red-700';
        bgClass = 'bg-red-50'; borderClass = 'border-red-200';
      }

      const levelText = document.getElementById('level-text');
      levelText.textContent = level;
      levelText.className = `text-xl font-bold ${levelColor}`;

      const resultSection = document.getElementById('result-section');
      resultSection.className = `rounded-2xl shadow-sm border p-6 mb-6 ${bgClass} ${borderClass}`;

      // å¯„ä¸åº¦ãƒãƒ¼
      const barContainer = document.getElementById('contribution-bar');
      const legendContainer = document.getElementById('contribution-legend');
      barContainer.innerHTML = '';
      legendContainer.innerHTML = '';

      const entries = Object.entries(contributions);
      entries.forEach(([key, value], i) => {
        const percentage = weeklyParticles > 0 ? (value / weeklyParticles) * 100 : 0;
        if (percentage > 0) {
          const bar = document.createElement('div');
          bar.className = `${colors[i]} transition-all duration-500`;
          bar.style.width = `${percentage}%`;
          barContainer.appendChild(bar);

          const legend = document.createElement('div');
          legend.className = 'flex items-center gap-1';
          legend.innerHTML = `<div class="w-3 h-3 rounded ${colors[i]}"></div><span class="text-gray-600">${contributorLabels[key]} ${percentage.toFixed(0)}%</span>`;
          legendContainer.appendChild(legend);
        }
      });

      // è¡Œå‹•å¤‰å®¹ã‚¢ã‚¤ãƒ†ãƒ 
      updateActionItems(bottledWater, teaBags, plasticHeating);
    }

    function updateActionItems(bottledWater, teaBags, plasticHeating) {
      const container = document.getElementById('action-items');
      const scenarios = [];

      if (bottledWater > 0) {
        const saved = bottledWater * (COEFFICIENTS.bottledWater - COEFFICIENTS.tapWater);
        scenarios.push({
          action: 'ãƒœãƒˆãƒ«æ°´ã‚’æ°´é“æ°´ã«åˆ‡æ›¿',
          weeklyReduction: saved,
          yearlyReduction: saved * 52,
          icon: 'ğŸš°'
        });
      }

      if (teaBags > 0) {
        const saved = teaBags * COEFFICIENTS.teaBag;
        scenarios.push({
          action: 'ãƒªãƒ¼ãƒ•ãƒ†ã‚£ãƒ¼ã¾ãŸã¯ç´™è£½ã«åˆ‡æ›¿',
          weeklyReduction: saved,
          yearlyReduction: saved * 52,
          icon: 'ğŸµ'
        });
      }

      if (plasticHeating > 0) {
        const saved = plasticHeating * COEFFICIENTS.plasticHeating;
        scenarios.push({
          action: 'ã‚¬ãƒ©ã‚¹ãƒ»é™¶å™¨å®¹å™¨ã§åŠ ç†±',
          weeklyReduction: saved,
          yearlyReduction: saved * 52,
          icon: 'ğŸ¥£'
        });
      }

      scenarios.sort((a, b) => b.weeklyReduction - a.weeklyReduction);

      container.innerHTML = scenarios.map(s => `
        <div class="flex items-center gap-4 p-4 bg-emerald-50 rounded-xl border border-emerald-100">
          <div class="text-2xl">${s.icon}</div>
          <div class="flex-1">
            <div class="font-medium text-gray-800">${s.action}</div>
            <div class="text-sm text-emerald-700">
              é€± -${formatNumber(s.weeklyReduction)} ç²’å­ï¼ˆå¹´é–“ -${formatNumber(s.yearlyReduction)}ï¼‰
            </div>
          </div>
        </div>
      `).join('');

      document.getElementById('action-section').style.display = scenarios.length > 0 ? 'block' : 'none';
    }

    function toggleDetails() {
      const content = document.getElementById('details-content');
      const arrow = document.getElementById('details-arrow');
      content.classList.toggle('hidden');
      arrow.textContent = content.classList.contains('hidden') ? 'â–¼' : 'â–²';
    }

    // åˆæœŸåŒ–
    updateSimulator();
  </script>
</body>
</html>
